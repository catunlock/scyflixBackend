<!DOCTYPE html>
<head>
</head>

<body>
    Insert doc id:<input type="text" value="" id="textbox">
    <button id='button'  style="margin-left: 20px; margin-right: 20px; margin-top: 20px; margin-bottom: 20px;">Execute GENSIM</button>
    <div id='table'>
    </div>
    <script src="jquery.js"></script>
    <script>
    var pdfRoute = "/home/segmentation-fault/uni/PAE/";
        $('#button').click(function() {
            document.getElementById("table").innerHTML = "";
            var url = "http://localhost:3000/?doc="+document.getElementById("textbox").value;
            var gensimData;
            var txt = "<table border='1'>";
            jQuery.support.cors = true;
            $.ajax ({
                url: url,
                datatype: "json",
                crossDomain: true,
                success: function (data) {
                    // Success callback
                    gensimData = data;
                    txt += "<table border='1'><tr><td><b>Paper name</b></td>";
                    for (x in gensimData) {
                        var pdf = gensimData[x].arxiv;
                        pdf = pdf.replace('.txt','.pdf');
                        txt += "<td><a href='"+pdfRoute+pdf+"'>"+gensimData[x].arxiv+"</a></td>"; 
                    }
                    txt += "</tr><tr><td><b>Similarity</b></td>"
                    for (x in gensimData) {
                        txt += "<td>"+gensimData[x].prob+"</td>"; 
                    }
                    txt += "</tr><th colspan='21' style='text-align: left'>Words comparisson</th></tr>";
                    
                    var words = new Array(20);
                    for (x in gensimData) {
                        words[x] = gensimData[x].document;
                        words[x] = words[x].replace('[','');
                        words[x] = words[x].replace(']','');
                        words[x] = words[x].split(",");
                        words[x] = words[x].sort();
                    }
                    var coincidencias = new Array(20);
                    for (x in words){
                        coincidencias[x] = 0;
                    }

                    
                    for (x in words){
                        for (k in words[x]){
                            txt += "<tr><td></td><td><b>"+words[x][k]+"</b></td>";
                            var wordSearch = words[x][k];
                            var i;
                            for (i = 1; i < words.length; i++) { 
                                if (words[i].indexOf(wordSearch) == -1){
                                    txt += "<td style = 'background-color: rgb(255, 0, 0)'></td>";                                
                                }
                                else{
                                    txt += "<td style = 'background-color: rgb(0, 255, 0)'></td>";
                                    coincidencias[i] += 1;
                                }
                            }
                        }
                    }
                    txt += "<tr><td></td>";
                    for (x in coincidencias){
                        txt += "<td>"+coincidencias[x]+"</td>";
                    }
                    txt += "</tr></table>";
                    document.getElementById("table").innerHTML = txt;                    
                    

                }})
        });
       
    </script>
</body>
